# Firebase Setup Guide

## Initial Setup

1. Go to [Firebase Console](https://console.firebase.google.com)
2. Create a new project or select an existing one
3. Enable required services:
   - Authentication
   - Cloud Firestore
   - Storage

## Authentication Setup

1. In Firebase Console, go to Authentication > Sign-in method
2. Enable Email/Password authentication
3. (Optional) Add other auth providers as needed

## Cloud Firestore Setup

1. Go to Firestore Database
2. Create database in production mode
3. Choose the closest region
4. Set up security rules:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // User profiles
    match /users/{userId} {
      allow read: if request.auth.uid == userId;
      allow write: if request.auth.uid == userId;
    }
    
    // Movies - public read, admin write
    match /movies/{movieId} {
      allow read: if true;
      allow write: if request.auth.token.admin == true;
    }
    
    // Showtimes - public read, admin write
    match /showtimes/{showtimeId} {
      allow read: if true;
      allow write: if request.auth.token.admin == true;
    }
    
    // Bookings - user specific
    match /bookings/{bookingId} {
      allow read: if request.auth.uid == resource.data.userId;
      allow create: if request.auth.uid != null;
      allow update: if request.auth.uid == resource.data.userId;
      allow delete: if request.auth.uid == resource.data.userId;
    }
  }
}
```

## Storage Setup

1. Go to Storage
2. Initialize Storage
3. Set up security rules:

```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /posters/{movieId} {
      allow read: if true;
      allow write: if request.auth.token.admin == true;
    }
    
    match /users/{userId}/{allPaths=**} {
      allow read: if request.auth.uid == userId;
      allow write: if request.auth.uid == userId;
    }
  }
}
```

## Android Setup

1. Register app in Firebase Console
   - Package name: `com.example.cinec_movie_app`
   - Download `google-services.json`
   - Place in `android/app/`

2. Add SHA certificate fingerprints
   - Debug SHA-1
   - Release SHA-1
   - App signing SHA-1

To get debug SHA-1:
```bash
cd android
./gradlew signingReport
```

## iOS Setup

1. Register iOS app in Firebase Console
   - Bundle ID: `com.example.cinecMovieApp`
   - Download `GoogleService-Info.plist`
   - Place in `ios/Runner/`

2. Update `ios/Runner/Info.plist` if needed

## Environment Configuration

1. Update `lib/firebase_options.dart`:
   - This file should be automatically generated by FlutterFire CLI

2. Install FlutterFire CLI:
```bash
dart pub global activate flutterfire_cli
```

3. Configure Firebase:
```bash
flutterfire configure
```

## Testing Firebase Connection

Add test code to verify Firebase connection:

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  
  // Test Firestore
  try {
    await FirebaseFirestore.instance.collection('test').add({
      'timestamp': FieldValue.serverTimestamp(),
    });
    print('Firestore connection successful');
  } catch (e) {
    print('Firestore error: $e');
  }
  
  // Test Authentication
  try {
    await FirebaseAuth.instance.signInAnonymously();
    print('Authentication successful');
  } catch (e) {
    print('Authentication error: $e');
  }
  
  runApp(MyApp());
}